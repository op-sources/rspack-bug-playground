{"version":3,"file":"index.cjs.js","sources":["../src/util.ts","../src/style.ts","../src/id.ts","../src/input.ts","../src/canvas.ts","../src/video.ts","../src/context.ts","../src/element.ts","../src/index.ts"],"sourcesContent":["import {\n  SupportedElement,\n  SupportedElementTagName,\n  SupportedElementTagNameMap,\n} from \"./types\";\n\nexport function isTagName<T extends SupportedElementTagName>(\n  el: SupportedElement,\n  tagNames: T[]\n): el is SupportedElementTagNameMap[T] {\n  return (tagNames as string[]).indexOf(el.tagName.toLowerCase()) !== -1;\n}\n","import { isTagName } from \"./util\";\nimport {\n  StyleInfo,\n  ElementStyleInfo,\n  PesudoStyleInfoMap,\n  SupportedElement,\n  StyleSnapshot,\n  SupportedElementTagName,\n} from \"./types\";\n\n/**\n * Surprisingly, <style> element can be appended to <input> and <textarea>\n * so we can support ::placeholder, and ::selection even for them.\n */\nconst SUPPORTED_PSEUDO_SELECTORS = [\n  \"::after\",\n  \"::before\",\n  \"::first-letter\",\n  \"::first-line\",\n  \"::marker\",\n  \"::placeholder\",\n  \"::selection\",\n];\n\nconst REPLACED_ELEMENTS: SupportedElementTagName[] = [\n  \"iframe\",\n  \"video\",\n  \"embed\",\n  \"img\",\n  \"audio\",\n  \"option\",\n  \"canvas\",\n  \"object\",\n  \"applet\",\n];\n\nconst VOID_ELEMENTS: SupportedElementTagName[] = [\n  \"area\",\n  \"base\",\n  \"br\",\n  \"col\",\n  \"embed\",\n  \"hr\",\n  \"img\",\n  \"input\",\n  \"link\",\n  \"meta\",\n  \"param\",\n  \"source\",\n  \"track\",\n  \"wbr\",\n];\n\nconst NO_GENERATE_CONTENT_ELEMENTS = REPLACED_ELEMENTS.concat(VOID_ELEMENTS);\n\nconst PLACEHOLDER_ELEMENTS: SupportedElementTagName[] = [\"input\", \"textarea\"];\n\nconst SKIPPED_PROPERTIES = [\"-webkit-locale\"];\n\nfunction setDefault(elem: SupportedElement): () => void {\n  const style = elem.getAttribute(\"style\");\n  elem.style.setProperty(\"all\", \"revert\", \"important\");\n\n  return () => {\n    if (style) {\n      elem.setAttribute(\"style\", style);\n    } else {\n      elem.removeAttribute(\"style\");\n    }\n  };\n}\n\nexport function getDefaultStyleInfo(\n  source: SupportedElement,\n  pseudoSelector?: string\n): StyleInfo {\n  const dispose = setDefault(source);\n  const info = getStyleInfo(source, pseudoSelector);\n  dispose();\n\n  return info;\n}\n\nexport function getStyleInfo(\n  source: SupportedElement,\n  pseudoSelector?: string\n): StyleInfo {\n  const computed = window.getComputedStyle(source, pseudoSelector);\n  const style = getStyleSnapshot(computed);\n  const { display, content } = style;\n\n  if (display === \"none\" || (pseudoSelector && content === \"none\")) {\n    return null;\n  }\n\n  if (!pseudoSelector) {\n    const { width, height } = source.getBoundingClientRect();\n\n    if (width * height === 0) {\n      return null;\n    }\n\n    const allPseudoStyleInfo: PesudoStyleInfoMap = Object.create(null);\n\n    for (const selector of SUPPORTED_PSEUDO_SELECTORS) {\n      const pseudoStyleInfo = getStyleInfo(source, selector);\n\n      if (pseudoStyleInfo) {\n        allPseudoStyleInfo[selector] = pseudoStyleInfo;\n      }\n    }\n\n    return {\n      style,\n      width: `${width}px`,\n      height: `${height}px`,\n      pseudo: allPseudoStyleInfo,\n    };\n  }\n\n  // pseudo elements\n  if (\n    content === \"none\" ||\n    (pseudoSelector === \"::marker\" && display !== \"list-item\") ||\n    ((pseudoSelector === \"::before\" || pseudoSelector === \"::after\") &&\n      isTagName(source as SupportedElement, NO_GENERATE_CONTENT_ELEMENTS)) ||\n    (pseudoSelector === \"::placeholder\" &&\n      !isTagName(source as SupportedElement, PLACEHOLDER_ELEMENTS))\n  ) {\n    return null;\n  }\n\n  return {\n    style,\n  };\n}\n\nexport function patchStyle(\n  target: SupportedElement,\n  styleInfo: StyleInfo,\n  defaultStyleInfo: StyleInfo\n): void {\n  if (!styleInfo) {\n    return;\n  }\n\n  const { style, width, height, pseudo } = styleInfo as ElementStyleInfo;\n  const defaultStyle = defaultStyleInfo?.style;\n  const pseudoDefault = (defaultStyleInfo as ElementStyleInfo).pseudo;\n\n  const cssText = generateCssText(\n    getStyleDiff(style, defaultStyle as StyleSnapshot)\n  );\n  target.style.cssText = cssText + target.style.cssText;\n\n  /**\n   * Patch size\n   *\n   * TODO: how to deal with inline elements?\n   */\n  if (style.display !== \"inline\") {\n    target.style.boxSizing = \"border-box\";\n    target.style.width = width;\n    target.style.height = height;\n    target.style.maxWidth = \"none\";\n    target.style.minWidth = \"auto\";\n  }\n\n  const pseudoCssTextList = [];\n\n  for (const selector in pseudo) {\n    const pseudoStyleInfo = pseudo[selector];\n    const pseudoDefaultStyleInfo = pseudoDefault[selector];\n\n    const pseudoStyle = pseudoStyleInfo.style;\n    const pseudoDefaultStyle = pseudoDefaultStyleInfo.style;\n    const cssText = generateCssText(\n      getStyleDiff(pseudoStyle, pseudoDefaultStyle)\n    );\n\n    const css = generatePseudoElementCSS(target, selector, cssText);\n\n    if (css) {\n      pseudoCssTextList.push(css);\n    }\n  }\n\n  if (pseudoCssTextList.length) {\n    const style = createStyleElement(pseudoCssTextList.join(\"\\n\"));\n\n    target.appendChild(style);\n  }\n}\n\nfunction generatePseudoElementCSS(\n  target: SupportedElement,\n  selector: string,\n  cssText: string\n): string {\n  if (!cssText) {\n    return \"\";\n  }\n\n  return `#${target.id}${selector}{${cssText}}`;\n}\n\nfunction createStyleElement(css: string): HTMLStyleElement {\n  const style = document.createElement(\"style\");\n  style.appendChild(document.createTextNode(css));\n\n  return style;\n}\n\nfunction getStyleSnapshot(style: CSSStyleDeclaration): StyleSnapshot {\n  const snapshot = Object.create({});\n  for (let i = 0; i < style.length; i++) {\n    const prop = style[i];\n    snapshot[prop] = style.getPropertyValue(prop);\n  }\n\n  return snapshot;\n}\n\nfunction getStyleDiff(\n  currentStyle: StyleSnapshot,\n  defaultStyle: StyleSnapshot\n): StyleSnapshot {\n  const diff = Object.create({});\n\n  for (const key in currentStyle) {\n    if (\n      SKIPPED_PROPERTIES.indexOf(key) === -1 &&\n      currentStyle[key] !== defaultStyle[key]\n    ) {\n      diff[key] = currentStyle[key];\n    }\n  }\n\n  return diff;\n}\n\nfunction generateCssText(style: StyleSnapshot): string {\n  const declarations = [];\n\n  for (const key in style) {\n    declarations.push(`${key}:${style[key]};`);\n  }\n\n  return declarations.join(\"\");\n}\n","let counter = Math.floor(Math.random() * 667384);\n\nexport function getUniqueId(prefix?: string): string {\n  const leading = prefix ? `${prefix}-` : \"\";\n  return leading + (counter++).toString(36);\n}\n\nexport function patchId(target: Element): void {\n  target.id = getUniqueId(\"clone-id\");\n}\n","import { getUniqueId } from \"./id\";\nimport { InputElement } from \"./types\";\n\nconst nameMap = Object.create(null);\n\nexport function patchInput(target: InputElement, source: InputElement): void {\n  const { name, type } = target;\n\n  /**\n   * Sync input values because they are not cloned with cloneNode.\n   */\n  if (type !== \"file\") {\n    target.value = source.value;\n  }\n\n  /**\n   * Patch `name` as only one of radio buttons that share the\n   * same name can be checked.\n   */\n  if (name && type === \"radio\") {\n    let mapped = nameMap[name];\n\n    if (!mapped) {\n      mapped = nameMap[name] = getUniqueId(\"clone-name\");\n    }\n\n    target.name = mapped;\n  }\n\n  if (source.disabled) {\n    target.disabled = true;\n  }\n}\n","export function patchCanvas(\n  target: HTMLCanvasElement,\n  source: HTMLCanvasElement\n): void {\n  const targetCtx = target.getContext(\"2d\");\n  targetCtx?.drawImage(source, 0, 0);\n}\n","declare global {\n  interface HTMLVideoElement {\n    captureStream(): MediaStream;\n    mozCaptureStream(): MediaStream;\n  }\n}\n\nexport function patchVideo(\n  target: HTMLVideoElement,\n  source: HTMLVideoElement\n): void {\n  const method = source.captureStream || source.mozCaptureStream;\n\n  target.controls = source.controls && source.paused;\n\n  if (!method) {\n    const sync = () => {\n      target.currentTime = source.currentTime;\n      if (source.paused) {\n        target.pause();\n      } else {\n        target.play();\n      }\n\n      target.removeEventListener(\"canplay\", sync);\n    };\n\n    target.addEventListener(\"canplay\", sync);\n\n    return;\n  }\n\n  const stream = method.call(source);\n\n  target.srcObject = stream;\n}\n","const INHERITED_ATTRS = [\"dir\", \"lang\", \"disabled\"];\n\nexport function patchContext(target: Element, source: Element): void {\n  const attrs = INHERITED_ATTRS.concat([]);\n  const seen = Object.create(null);\n  let current: Element | null = source;\n\n  patch: while (current) {\n    for (let i = 0; i < attrs.length; i++) {\n      const key = attrs[i];\n\n      if (seen[key]) {\n        return;\n      }\n\n      const attr = current.getAttribute(key);\n      if (attr !== null) {\n        target.setAttribute(key, attr);\n        seen[key] = true;\n\n        if (Object.keys(seen).length === attrs.length) {\n          break patch;\n        }\n      }\n    }\n\n    current = current.parentElement;\n  }\n}\n\n/**\n * Context\n *\n * dir -> :dir\n * lang -> :lang\n * disabled\n */\n","import { patchInput } from \"./input\";\nimport { patchCanvas } from \"./canvas\";\nimport { patchVideo } from \"./video\";\nimport { SupportedElement, StyleInfo } from \"./types\";\nimport { patchId } from \"./id\";\nimport { isTagName } from \"./util\";\nimport { patchContext } from \"./context\";\n\nexport function patchElement(\n  target: SupportedElement,\n  source: SupportedElement,\n  styleInfo: StyleInfo\n): void {\n  if (!styleInfo) {\n    // invisible elements don't need to be patched\n    return;\n  }\n  patchId(target);\n  patchContext(target, source);\n\n  if (isTagName(target, [\"input\", \"textarea\", \"select\"])) {\n    patchInput(target, source as typeof target);\n  } else if (isTagName(target, [\"canvas\"])) {\n    patchCanvas(target, source as typeof target);\n  } else if (isTagName(target, [\"video\"])) {\n    patchVideo(target, source as typeof target);\n  }\n}\n","import { getDefaultStyleInfo, getStyleInfo, patchStyle } from \"./style\";\nimport { patchElement } from \"./element\";\nimport { SupportedElement } from \"./types\";\n\nexport default function cloneElement(source: Element): Element {\n  const target = source.cloneNode(true) as Element;\n\n  const targetElements = [target].concat(\n    Array.from(target.querySelectorAll(\"*\"))\n  );\n  const sourceElements = [source].concat(\n    Array.from(source.querySelectorAll(\"*\"))\n  );\n\n  if (targetElements.length !== sourceElements.length) {\n    throw new Error(\n      \"[clone-element] Cannot correctly clone the given element.\"\n    );\n  }\n\n  const styleInfoList = sourceElements.map((s) =>\n    getStyleInfo(s as SupportedElement)\n  );\n\n  targetElements.forEach((t, i) => {\n    const s = sourceElements[i];\n    patchElement(\n      t as SupportedElement,\n      s as SupportedElement,\n      styleInfoList[i]\n    );\n  });\n\n  document.body.appendChild(target);\n  const defaultStyleInfoList = targetElements.map((t) =>\n    getDefaultStyleInfo(t as SupportedElement)\n  );\n  document.body.removeChild(target);\n\n  targetElements.forEach((t, i) => {\n    patchStyle(\n      t as SupportedElement,\n      styleInfoList[i],\n      defaultStyleInfoList[i]\n    );\n  });\n\n  return target;\n}\n"],"names":[],"mappings":"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"}
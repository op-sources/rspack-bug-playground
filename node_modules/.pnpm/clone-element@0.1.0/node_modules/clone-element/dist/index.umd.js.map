{"version":3,"file":"index.umd.js","sources":["../src/util.ts","../src/style.ts","../src/id.ts","../src/input.ts","../src/canvas.ts","../src/video.ts","../src/context.ts","../src/element.ts","../src/index.ts"],"sourcesContent":["import {\n  SupportedElement,\n  SupportedElementTagName,\n  SupportedElementTagNameMap,\n} from \"./types\";\n\nexport function isTagName<T extends SupportedElementTagName>(\n  el: SupportedElement,\n  tagNames: T[]\n): el is SupportedElementTagNameMap[T] {\n  return (tagNames as string[]).indexOf(el.tagName.toLowerCase()) !== -1;\n}\n","import { isTagName } from \"./util\";\nimport {\n  StyleInfo,\n  ElementStyleInfo,\n  PesudoStyleInfoMap,\n  SupportedElement,\n  StyleSnapshot,\n  SupportedElementTagName,\n} from \"./types\";\n\n/**\n * Surprisingly, <style> element can be appended to <input> and <textarea>\n * so we can support ::placeholder, and ::selection even for them.\n */\nconst SUPPORTED_PSEUDO_SELECTORS = [\n  \"::after\",\n  \"::before\",\n  \"::first-letter\",\n  \"::first-line\",\n  \"::marker\",\n  \"::placeholder\",\n  \"::selection\",\n];\n\nconst REPLACED_ELEMENTS: SupportedElementTagName[] = [\n  \"iframe\",\n  \"video\",\n  \"embed\",\n  \"img\",\n  \"audio\",\n  \"option\",\n  \"canvas\",\n  \"object\",\n  \"applet\",\n];\n\nconst VOID_ELEMENTS: SupportedElementTagName[] = [\n  \"area\",\n  \"base\",\n  \"br\",\n  \"col\",\n  \"embed\",\n  \"hr\",\n  \"img\",\n  \"input\",\n  \"link\",\n  \"meta\",\n  \"param\",\n  \"source\",\n  \"track\",\n  \"wbr\",\n];\n\nconst NO_GENERATE_CONTENT_ELEMENTS = REPLACED_ELEMENTS.concat(VOID_ELEMENTS);\n\nconst PLACEHOLDER_ELEMENTS: SupportedElementTagName[] = [\"input\", \"textarea\"];\n\nconst SKIPPED_PROPERTIES = [\"-webkit-locale\"];\n\nfunction setDefault(elem: SupportedElement): () => void {\n  const style = elem.getAttribute(\"style\");\n  elem.style.setProperty(\"all\", \"revert\", \"important\");\n\n  return () => {\n    if (style) {\n      elem.setAttribute(\"style\", style);\n    } else {\n      elem.removeAttribute(\"style\");\n    }\n  };\n}\n\nexport function getDefaultStyleInfo(\n  source: SupportedElement,\n  pseudoSelector?: string\n): StyleInfo {\n  const dispose = setDefault(source);\n  const info = getStyleInfo(source, pseudoSelector);\n  dispose();\n\n  return info;\n}\n\nexport function getStyleInfo(\n  source: SupportedElement,\n  pseudoSelector?: string\n): StyleInfo {\n  const computed = window.getComputedStyle(source, pseudoSelector);\n  const style = getStyleSnapshot(computed);\n  const { display, content } = style;\n\n  if (display === \"none\" || (pseudoSelector && content === \"none\")) {\n    return null;\n  }\n\n  if (!pseudoSelector) {\n    const { width, height } = source.getBoundingClientRect();\n\n    if (width * height === 0) {\n      return null;\n    }\n\n    const allPseudoStyleInfo: PesudoStyleInfoMap = Object.create(null);\n\n    for (const selector of SUPPORTED_PSEUDO_SELECTORS) {\n      const pseudoStyleInfo = getStyleInfo(source, selector);\n\n      if (pseudoStyleInfo) {\n        allPseudoStyleInfo[selector] = pseudoStyleInfo;\n      }\n    }\n\n    return {\n      style,\n      width: `${width}px`,\n      height: `${height}px`,\n      pseudo: allPseudoStyleInfo,\n    };\n  }\n\n  // pseudo elements\n  if (\n    content === \"none\" ||\n    (pseudoSelector === \"::marker\" && display !== \"list-item\") ||\n    ((pseudoSelector === \"::before\" || pseudoSelector === \"::after\") &&\n      isTagName(source as SupportedElement, NO_GENERATE_CONTENT_ELEMENTS)) ||\n    (pseudoSelector === \"::placeholder\" &&\n      !isTagName(source as SupportedElement, PLACEHOLDER_ELEMENTS))\n  ) {\n    return null;\n  }\n\n  return {\n    style,\n  };\n}\n\nexport function patchStyle(\n  target: SupportedElement,\n  styleInfo: StyleInfo,\n  defaultStyleInfo: StyleInfo\n): void {\n  if (!styleInfo) {\n    return;\n  }\n\n  const { style, width, height, pseudo } = styleInfo as ElementStyleInfo;\n  const defaultStyle = defaultStyleInfo?.style;\n  const pseudoDefault = (defaultStyleInfo as ElementStyleInfo).pseudo;\n\n  const cssText = generateCssText(\n    getStyleDiff(style, defaultStyle as StyleSnapshot)\n  );\n  target.style.cssText = cssText + target.style.cssText;\n\n  /**\n   * Patch size\n   *\n   * TODO: how to deal with inline elements?\n   */\n  if (style.display !== \"inline\") {\n    target.style.boxSizing = \"border-box\";\n    target.style.width = width;\n    target.style.height = height;\n    target.style.maxWidth = \"none\";\n    target.style.minWidth = \"auto\";\n  }\n\n  const pseudoCssTextList = [];\n\n  for (const selector in pseudo) {\n    const pseudoStyleInfo = pseudo[selector];\n    const pseudoDefaultStyleInfo = pseudoDefault[selector];\n\n    const pseudoStyle = pseudoStyleInfo.style;\n    const pseudoDefaultStyle = pseudoDefaultStyleInfo.style;\n    const cssText = generateCssText(\n      getStyleDiff(pseudoStyle, pseudoDefaultStyle)\n    );\n\n    const css = generatePseudoElementCSS(target, selector, cssText);\n\n    if (css) {\n      pseudoCssTextList.push(css);\n    }\n  }\n\n  if (pseudoCssTextList.length) {\n    const style = createStyleElement(pseudoCssTextList.join(\"\\n\"));\n\n    target.appendChild(style);\n  }\n}\n\nfunction generatePseudoElementCSS(\n  target: SupportedElement,\n  selector: string,\n  cssText: string\n): string {\n  if (!cssText) {\n    return \"\";\n  }\n\n  return `#${target.id}${selector}{${cssText}}`;\n}\n\nfunction createStyleElement(css: string): HTMLStyleElement {\n  const style = document.createElement(\"style\");\n  style.appendChild(document.createTextNode(css));\n\n  return style;\n}\n\nfunction getStyleSnapshot(style: CSSStyleDeclaration): StyleSnapshot {\n  const snapshot = Object.create({});\n  for (let i = 0; i < style.length; i++) {\n    const prop = style[i];\n    snapshot[prop] = style.getPropertyValue(prop);\n  }\n\n  return snapshot;\n}\n\nfunction getStyleDiff(\n  currentStyle: StyleSnapshot,\n  defaultStyle: StyleSnapshot\n): StyleSnapshot {\n  const diff = Object.create({});\n\n  for (const key in currentStyle) {\n    if (\n      SKIPPED_PROPERTIES.indexOf(key) === -1 &&\n      currentStyle[key] !== defaultStyle[key]\n    ) {\n      diff[key] = currentStyle[key];\n    }\n  }\n\n  return diff;\n}\n\nfunction generateCssText(style: StyleSnapshot): string {\n  const declarations = [];\n\n  for (const key in style) {\n    declarations.push(`${key}:${style[key]};`);\n  }\n\n  return declarations.join(\"\");\n}\n","let counter = Math.floor(Math.random() * 667384);\n\nexport function getUniqueId(prefix?: string): string {\n  const leading = prefix ? `${prefix}-` : \"\";\n  return leading + (counter++).toString(36);\n}\n\nexport function patchId(target: Element): void {\n  target.id = getUniqueId(\"clone-id\");\n}\n","import { getUniqueId } from \"./id\";\nimport { InputElement } from \"./types\";\n\nconst nameMap = Object.create(null);\n\nexport function patchInput(target: InputElement, source: InputElement): void {\n  const { name, type } = target;\n\n  /**\n   * Sync input values because they are not cloned with cloneNode.\n   */\n  if (type !== \"file\") {\n    target.value = source.value;\n  }\n\n  /**\n   * Patch `name` as only one of radio buttons that share the\n   * same name can be checked.\n   */\n  if (name && type === \"radio\") {\n    let mapped = nameMap[name];\n\n    if (!mapped) {\n      mapped = nameMap[name] = getUniqueId(\"clone-name\");\n    }\n\n    target.name = mapped;\n  }\n\n  if (source.disabled) {\n    target.disabled = true;\n  }\n}\n","export function patchCanvas(\n  target: HTMLCanvasElement,\n  source: HTMLCanvasElement\n): void {\n  const targetCtx = target.getContext(\"2d\");\n  targetCtx?.drawImage(source, 0, 0);\n}\n","declare global {\n  interface HTMLVideoElement {\n    captureStream(): MediaStream;\n    mozCaptureStream(): MediaStream;\n  }\n}\n\nexport function patchVideo(\n  target: HTMLVideoElement,\n  source: HTMLVideoElement\n): void {\n  const method = source.captureStream || source.mozCaptureStream;\n\n  target.controls = source.controls && source.paused;\n\n  if (!method) {\n    const sync = () => {\n      target.currentTime = source.currentTime;\n      if (source.paused) {\n        target.pause();\n      } else {\n        target.play();\n      }\n\n      target.removeEventListener(\"canplay\", sync);\n    };\n\n    target.addEventListener(\"canplay\", sync);\n\n    return;\n  }\n\n  const stream = method.call(source);\n\n  target.srcObject = stream;\n}\n","const INHERITED_ATTRS = [\"dir\", \"lang\", \"disabled\"];\n\nexport function patchContext(target: Element, source: Element): void {\n  const attrs = INHERITED_ATTRS.concat([]);\n  const seen = Object.create(null);\n  let current: Element | null = source;\n\n  patch: while (current) {\n    for (let i = 0; i < attrs.length; i++) {\n      const key = attrs[i];\n\n      if (seen[key]) {\n        return;\n      }\n\n      const attr = current.getAttribute(key);\n      if (attr !== null) {\n        target.setAttribute(key, attr);\n        seen[key] = true;\n\n        if (Object.keys(seen).length === attrs.length) {\n          break patch;\n        }\n      }\n    }\n\n    current = current.parentElement;\n  }\n}\n\n/**\n * Context\n *\n * dir -> :dir\n * lang -> :lang\n * disabled\n */\n","import { patchInput } from \"./input\";\nimport { patchCanvas } from \"./canvas\";\nimport { patchVideo } from \"./video\";\nimport { SupportedElement, StyleInfo } from \"./types\";\nimport { patchId } from \"./id\";\nimport { isTagName } from \"./util\";\nimport { patchContext } from \"./context\";\n\nexport function patchElement(\n  target: SupportedElement,\n  source: SupportedElement,\n  styleInfo: StyleInfo\n): void {\n  if (!styleInfo) {\n    // invisible elements don't need to be patched\n    return;\n  }\n  patchId(target);\n  patchContext(target, source);\n\n  if (isTagName(target, [\"input\", \"textarea\", \"select\"])) {\n    patchInput(target, source as typeof target);\n  } else if (isTagName(target, [\"canvas\"])) {\n    patchCanvas(target, source as typeof target);\n  } else if (isTagName(target, [\"video\"])) {\n    patchVideo(target, source as typeof target);\n  }\n}\n","import { getDefaultStyleInfo, getStyleInfo, patchStyle } from \"./style\";\nimport { patchElement } from \"./element\";\nimport { SupportedElement } from \"./types\";\n\nexport default function cloneElement(source: Element): Element {\n  const target = source.cloneNode(true) as Element;\n\n  const targetElements = [target].concat(\n    Array.from(target.querySelectorAll(\"*\"))\n  );\n  const sourceElements = [source].concat(\n    Array.from(source.querySelectorAll(\"*\"))\n  );\n\n  if (targetElements.length !== sourceElements.length) {\n    throw new Error(\n      \"[clone-element] Cannot correctly clone the given element.\"\n    );\n  }\n\n  const styleInfoList = sourceElements.map((s) =>\n    getStyleInfo(s as SupportedElement)\n  );\n\n  targetElements.forEach((t, i) => {\n    const s = sourceElements[i];\n    patchElement(\n      t as SupportedElement,\n      s as SupportedElement,\n      styleInfoList[i]\n    );\n  });\n\n  document.body.appendChild(target);\n  const defaultStyleInfoList = targetElements.map((t) =>\n    getDefaultStyleInfo(t as SupportedElement)\n  );\n  document.body.removeChild(target);\n\n  targetElements.forEach((t, i) => {\n    patchStyle(\n      t as SupportedElement,\n      styleInfoList[i],\n      defaultStyleInfoList[i]\n    );\n  });\n\n  return target;\n}\n"],"names":[],"mappings":"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"}
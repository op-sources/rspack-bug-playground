/**
 * @file 自定义item
 * @author huangshiming
 * @date 2020-05-16
 */

import React from 'react';
import {flattenDeep} from 'lodash';

interface CommonItemProps {
    title: string,
    relationText: string,
    searchValue?: string,
    prefixCls: string
};

const CommonItemRender = (props: CommonItemProps) => {
    const {
        title,
        relationText,
        searchValue,
        prefixCls
    } = props;
    let textArray = [<span key="normal-0">{title}</span>];
    if (searchValue) {
        const pivolIndex = title.indexOf(searchValue);
        if (pivolIndex > -1) {
            textArray = flattenDeep(title.split(searchValue).map((node, index) => {
                return index === 0
                    ? [<span key={index}>{node}</span>]
                    : [
                        <span
                            key={`${index}-highlight`}
                            className={`${prefixCls}-title-highlight`}
                        >
                            {searchValue}
                        </span>,
                        <span key={index}>{node}</span>
                    ];
            }));
        }
    }
    return title
        ? (
            <span title={title} className={`${prefixCls}-item-title`}>
                {textArray}
                <span className={`${prefixCls}-relation-text`}>
                    {' '}
                    {relationText}
                </span>
            </span>
        )
        : null; // 有构造数据的 id 不存在
};

CommonItemRender.defaultProps = {
    title: '',
    relationText: ''
};

export default CommonItemRender;
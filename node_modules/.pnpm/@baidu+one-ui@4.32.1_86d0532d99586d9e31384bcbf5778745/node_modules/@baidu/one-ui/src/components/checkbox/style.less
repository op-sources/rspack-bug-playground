@import '../../style/index.less';

@checkbox-prefix-cls: ~"@{one-prefix}-checkbox";
@tree-checkbox-prefix-cls: ~"@{one-prefix}-tree-checkbox";
@checkbox-prefix-cls-wrapper: ~"@{checkbox-prefix-cls}-wrapper";
@checkbox-prefix-cls-wrapper-s: ~"@{checkbox-prefix-cls-wrapper}-small";
@checkbox-group-prefix-cls: ~"@{checkbox-prefix-cls}-group";
@checkbox-group-prefix-cls-column: ~"@{checkbox-group-prefix-cls}-column";
@checkbox-inner-prefix-cls: ~"@{checkbox-prefix-cls}-inner";
@checkbox-prefix-cls-wrapper-disabled: ~"@{checkbox-prefix-cls-wrapper}-disabled";

.checkbox-border-style(@border-color, @background-color) {
    border: @dls-checkbox-border-width @dls-checkbox-border-style @border-color;
    background-color: @background-color;
}

.checkbox-size(@font-size, @height, @border-raduis) {
    font-size: @font-size;
    & + span { // 保留早期实现
        font-size: @font-size;
    }
    .@{checkbox-prefix-cls} {
        top: calc((@height -  1em)/ 2 + 0.14em);
        &-checked:after {
            border-radius: @border-raduis;
        }
        &-inner {
            .common-height-width(@height);
            border-radius: @border-raduis;
            &:after {
                .checkbox-inner-after(@height);
            }
        }
    }
}

.checkbox-inner-foreground-style(@border-color, @background-color) {
    border-color: @border-color;
    background-color: @background-color;
}

.checkbox-checked-or-indeterminate-inner-style(@border-color, @foreground-color, @background-color) {
    .@{checkbox-prefix-cls} {
        &-checked,
        &-indeterminate {
            .@{checkbox-inner-prefix-cls} {
                .checkbox-inner-foreground-style(
                    @border-color,
                    @background-color
                );
                &:after {
                    .checkbox-inner-foreground-style(@foreground-color, @background-color);
                }
            }
        }
    }
}

.checkbox-checked-or-indeterminate(
    @checkbox-border-color-checked,
    @checkbox-border-color-checked-hover,
    @checkbox-border-color-checked-focus,
    @checkbox-border-color-checked-active,
    @checkbox-background-color-checked,
    @checkbox-background-color-checked-hover,
    @checkbox-background-color-checked-focus,
    @checkbox-background-color-checked-active,
    @checkbox-foreground-color
) {
    .checkbox-checked-or-indeterminate-inner-style(@checkbox-border-color-checked, @checkbox-foreground-color, @checkbox-background-color-checked);
    &:hover {
        .checkbox-checked-or-indeterminate-inner-style(@checkbox-border-color-checked-hover, @checkbox-foreground-color, @checkbox-background-color-checked-hover);
    }
    &:active {
        .checkbox-checked-or-indeterminate-inner-style(@checkbox-border-color-checked-active, @checkbox-foreground-color, @checkbox-background-color-checked-active);
    }
}

// 一般状态
.@{tree-checkbox-prefix-cls},
.@{checkbox-prefix-cls} {
    white-space: nowrap;
    outline: none;
    display: inline-block;
    position: relative;
    .focus-visible + .@{checkbox-prefix-cls}-inner,
    [data-focus-visible-added] + .@{checkbox-prefix-cls}-inner {
        box-shadow: @dls-checkbox-shadow-focus;
    }

    .@{checkbox-prefix-cls-wrapper}:hover &-inner,
    &:hover &-inner {
        .checkbox-border-style(
            @dls-checkbox-border-color-hover,
            @dls-checkbox-background-color-hover
        );
    }

    .@{checkbox-prefix-cls-wrapper}:active &-inner,
    &:active &-inner {
        .checkbox-border-style(
            @dls-checkbox-border-color-active,
            @dls-checkbox-background-color-active
        );
    }

    .@{checkbox-prefix-cls-wrapper}&.focus-visible &-inner,
    &.focus-visible &-inner,
    &-input&.focus-visible + &-inner {
        .checkbox-border-style(
            @dls-checkbox-border-color-focus,
            @dls-checkbox-background-color-focus
        );
    }

    &-checked:after {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        // border: @dls-checkbox-border-width @dls-checkbox-border-style @dls-checkbox-background-color-checked;
        content: '';
        visibility: hidden;
        box-sizing: border-box;
    }

    &:hover:after,
    .@{checkbox-prefix-cls-wrapper}:hover &:after {
        visibility: visible;
    }

    &-inner {
        position: relative;
        top: 0;
        left: 0;
        display: block;
        color: #fff;
        .checkbox-border-style(@dls-checkbox-border-color, @dls-checkbox-background-color);
        .dls-icon {
            position: absolute;
            left: 50%;
            top: 50%;
            margin: auto;
            transform: translate(-50%, -50%) scale(1.25);
            path {
                transform: scale(0.8);
                transform-origin: 50% 50%;
                stroke: currentColor;
                stroke-width: 1px;
            }
        }
    }

    &-input {
        position: absolute;
        left: 0;
        z-index: 1;
        cursor: pointer;
        opacity: 0;
        top: 0;
        bottom: 0;
        right: 0;
        width: 100%;
        height: 100%;
    }
}

.@{checkbox-prefix-cls-wrapper} {
    font-size: inherit;
    margin-right: @dls-radio-and-checkbox-wrapper-margin-right;
    cursor: pointer;
    display: inline-flex;
    align-items: baseline;
    line-height: unset;
    color: @dls-checkbox-font-color;
    * {
        box-sizing: border-box !important;
    }
    &:last-of-type {
        margin-right: 0;
    }
    // 全选/半选
    &:not(&-disabled) {
        .checkbox-checked-or-indeterminate(
            @dls-checkbox-border-color-checked,
            @dls-checkbox-border-color-checked-hover,
            @dls-checkbox-border-color-checked-focus,
            @dls-checkbox-border-color-checked-active,
            @dls-checkbox-background-color-checked,
            @dls-checkbox-background-color-checked-hover,
            @dls-checkbox-background-color-checked-focus,
            @dls-checkbox-background-color-checked-active,
            @dls-checkbox-foreground-color
        );
    }
    &::after {
        display: inline-block;
        width: 0;
        overflow: hidden;
        content: "\200b";
    }
    .checkbox-size(@dls-checkbox-font-size-m, @dls-checkbox-size-m, @dls-checkbox-border-radius);
}

.@{checkbox-prefix-cls-wrapper} + span,
.@{checkbox-prefix-cls} + span {
    padding-left: @dls-radio-and-checkbox-wrapper-text-padding-left;
}

.@{checkbox-prefix-cls-wrapper-s} {
    .checkbox-size(@dls-checkbox-font-size-s, @dls-checkbox-size-s, @dls-checkbox-border-radius);
    .@{checkbox-prefix-cls}-indeterminate {
        .@{checkbox-inner-prefix-cls} {
            &:after {
                .checkbox-inner-after-indeterminate(@dls-checkbox-size-s);
            }
        }
    }
}

.@{checkbox-prefix-cls-wrapper-disabled} {
    cursor: not-allowed;
    color: @dls-checkbox-font-color-disabled;
    .@{checkbox-prefix-cls}-disabled {
        .@{checkbox-prefix-cls}-inner {
            .checkbox-border-style(
                @dls-checkbox-border-color-disabled,
                @dls-checkbox-background-color-disabled
            );
        }
        .@{checkbox-prefix-cls}-input {
            cursor: not-allowed;
        }
        & + span {
            cursor: not-allowed;
        }
    }
    .checkbox-checked-or-indeterminate-inner-style(@dls-checkbox-border-color-checked-disabled, @dls-checkbox-foreground-color, @dls-checkbox-background-color-checked-disabled);
}

.@{checkbox-prefix-cls}-group {
    display: inline-block;
    &-item {
        display: inline-block;
        &:last-child {
            margin-right: 0;
        }
    }
}

.@{checkbox-prefix-cls}-group-medium {
    .radio-and-checkbox-radius(@checkbox-prefix-cls, @dls-button-border-radius-m);
}

.@{checkbox-prefix-cls}-group-small {
    .radio-and-checkbox-radius(@checkbox-prefix-cls, @dls-button-border-radius-s);
}

.@{checkbox-prefix-cls}-button-wrapper {
    position: relative;
    &-strong-icon {
        position: absolute;
        top: @dls-checkbox-icon-spacing-strong;
        right: @dls-checkbox-icon-spacing-strong;
        border: (@dls-checkbox-icon-size-strong / 2) solid @dls-button-border-color-normal;
        border-color: @dls-checkbox-icon-color-strong @dls-checkbox-icon-color-strong transparent transparent;
    }
    &-simple:not(&-checked) &-strong-icon,
    &-simple&-disabled:not(&-checked) &-strong-icon {
        border-color: transparent;
    }
    &-simple:hover &-strong-icon {
        border-top-color: @dls-checkbox-icon-color-strong;
        border-right-color: @dls-checkbox-icon-color-strong;
    }
    &-disabled &-strong-icon {
        border-top-color: @dls-checkbox-icon-color-strong-disabled;
        border-right-color: @dls-checkbox-icon-color-strong-disabled;
    }
    &&-checked &-strong-icon {
        border-top-color: @dls-checkbox-icon-color-strong-checked;
        border-right-color: @dls-checkbox-icon-color-strong-checked;
    }
    &-checked&-disabled &-strong-icon {
        border-top-color: @dls-checkbox-icon-color-strong-checked-disabled;
        border-right-color: @dls-checkbox-icon-color-strong-checked-disabled;
    }
}

.@{checkbox-prefix-cls}-checked {
    .focus-visible + .@{checkbox-prefix-cls}-inner,
    [data-focus-visible-added] + .@{checkbox-prefix-cls}-inner {
        .checkbox-inner-foreground-style(
            @dls-checkbox-border-color-checked-focus,
            @dls-checkbox-background-color-checked-focus
        );
        box-shadow: @dls-checkbox-shadow-focus;
        &:after {
            background-color: @dls-checkbox-background-color-checked-focus;
        }
    }
}

// 加强多选
.radio-or-checkbox-button-mixins(
    @checkbox-prefix-cls,
    @dls-button-height-m,
    @dls-button-height-s,
    @dls-button-padding-m,
    @dls-button-padding-s,
    @dls-button-border-color-basic,
    @dls-button-border-color-basic,
    @dls-button-border-color-basic,
    @dls-button-border-color-basic,
    @dls-button-background-color-basic,
    @dls-button-background-color-basic-hover,
    @dls-button-background-color-basic-focus,
    @dls-button-background-color-basic-active,
    @dls-button-border-color-selected,
    @dls-button-border-color-selected,
    @dls-button-border-color-selected,
    @dls-button-border-color-selected,
    @dls-button-background-color-checked,
    @dls-button-background-color-checked-hover,
    @dls-button-background-color-checked-focus,
    @dls-button-background-color-checked-active,
    @dls-button-border-color-basic-disabled,
    @dls-button-background-color-basic-disabled,
    @dls-button-background-color-checked-disabled,
    @dls-button-border-color-selected-disabled,
    @dls-checkbox-group-spacing-simple,
    @dls-checkbox-group-line-spacing
);

.radio-or-checkbox-column-mixins(@checkbox-prefix-cls, @dls-radio-and-checkbox-wrapper-column-margin);

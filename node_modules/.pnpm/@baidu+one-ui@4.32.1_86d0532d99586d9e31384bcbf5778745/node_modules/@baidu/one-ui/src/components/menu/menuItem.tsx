import React, {PureComponent} from 'react';
import InnerMenuItem from './common/menuItem';
import Tooltip from '../tooltip';
import {MenuItemProps} from './interface';
import Context from './context';

class MenuItem extends PureComponent<MenuItemProps> {
    static isMenuItem = true;

    static contextType = Context;

    static defaultProps = {
        prefixCls: 'one-menu'
    };

    render() {
        const {inlineCollapsed} = this.context;
        const {
            children,
            icon,
            level,
            prefixCls
        } = this.props;
        const collapsed = icon && inlineCollapsed && level === 1;
        const item = (
            <InnerMenuItem {...this.props}>
                <span className={`${prefixCls}-item-span`}>
                    {icon
                        && (
                            <span className={`${prefixCls}-item-custom-icon`}>
                                {icon}
                            </span>
                        )
                    }
                    {!collapsed && children}
                </span>
            </InnerMenuItem>
        );
        if (!(inlineCollapsed && level === 1)) {
            return item;
        }
        return (
            <Tooltip
                title={
                    <span className={`${prefixCls}-inline-collapsed-tooltip-title`}>{children}</span>
                }
                placement="right"
                overlayClassName={`${prefixCls}-inline-collapsed-tooltip`}
            >
                {item}
            </Tooltip>
        );
    }
}

export default MenuItem;

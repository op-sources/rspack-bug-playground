@import '../../style/index.less';
@import '../../style/mixins/tipsAndError.less';

@select-prefix-cls: ~"@{one-prefix}-select";
@single-select-prefix-cls: ~"@{one-prefix}-single-select";
@multiple-select-prefix-cls: ~"@{one-prefix}-multiple-select";
@select-popover-prefix-cls: ~"@{one-prefix}-select-popover";
@select-pop-prefix-cls: ~"@{one-prefix}-select-pop";
@select-checkbox-cls: ~"@{one-prefix}-checkbox-wrapper";
@loading-prefix-cls: ~"@{one-prefix}-loading";

.select-size(@height, @size, @font-size, @option-height, @border-radius, @top, @tag-height, @option-padding) {
    .@{select-prefix-cls}-@{size} {
        font-size: @font-size;
        border-radius: @border-radius;
        .@{select-prefix-cls}-selection {
            border-radius: @border-radius;
        }
        .@{select-prefix-cls}-selection-text-error {
            font-size: @font-size;
        }
        .@{select-prefix-cls}-selection__rendered {
            line-height: @height - 2px;
        }
        .@{select-prefix-cls}-selection--multiple {
            min-height: @height - 2px;
            .@{select-prefix-cls}-selection__choice {
                height: @tag-height;
                line-height: @tag-height;
                margin-top: @dls-select-padding-y - 1px;
                margin-bottom: @dls-select-padding-y - 1px;
            }
            .@{select-prefix-cls}-selection__clear,
            .@{select-prefix-cls}-arrow {
                top: @top;
            }
            .@{select-prefix-cls}-search__field__wrap {
                input {
                    font-size: @font-size;
                }
            }
        }
    }
    .@{select-prefix-cls}-dropdown-@{size} {
        border-radius: @border-radius;
        .@{select-prefix-cls}-dropdown-menu {
            &-item {
                height: @option-height;
                line-height: @option-height;
                font-size: @font-size;
                .@{select-checkbox-cls} + span {
                    font-size: @font-size;
                }
                padding: 0 @option-padding;
            }
            &-footer {
                padding: @dls-option-group-padding-y * 2 @option-padding;
            }
            &-empty {
                height: auto;
            }
            &-item-group-title {
                height: @option-height;
                line-height: @option-height;
                font-size: @font-size;
                padding: 0 @option-padding;
            }
        }
    }
}

.select-size(
    @dls-input-height-xs,
    xsmall,
    @dls-input-font-size-xs,
    @dls-option-height-xs,
    @dls-button-border-radius-s,
    3 * @dls-padding-unit,
    @dls-select-tag-height-xs,
    @dls-option-padding-xs
);
.select-size(
    @dls-input-height-s,
    small,
    @dls-input-font-size-s,
    @dls-option-height-s,
    @dls-button-border-radius-s,
    3 * @dls-padding-unit + 2px,
    @dls-select-tag-height-s,
    @dls-option-padding-s
);
.select-size(
    @dls-input-height-m,
    medium,
    @dls-input-font-size-m,
    @dls-option-height-m,
    @dls-button-border-radius-m,
    4 * @dls-padding-unit,
    @dls-select-tag-height-m,
    @dls-option-padding-m
);
.select-size(
    @dls-input-height-l,
    large,
    @dls-input-font-size-l,
    @dls-option-height-l,
    @dls-button-border-radius-l,
    5 * @dls-padding-unit - 2px,
    @dls-select-tag-height-l,
    @dls-option-padding-l
);

.@{select-prefix-cls}-disabled {
    border: 1px solid @dls-input-border-color-disabled;
    background-color: @dls-input-background-color-disabled;
    color: @dls-input-font-color-disabled;
    cursor: not-allowed;
    &:hover, &:active, &:focus {
        border-color: @dls-input-border-color-disabled;
    }
    .@{select-prefix-cls}-selection__placeholder {
        color: @dls-input-font-color-disabled;
    }
    .@{select-prefix-cls}-selection--multiple[type='list'] {
        cursor: not-allowed;
        .@{select-prefix-cls}-selection__choice {
            cursor: not-allowed;
            color: @dls-input-font-color-disabled;
            background-color: fade(@dls-tag-color, percentage(@dls-tag-background-opacity-disabled));
            &__remove {
                cursor: not-allowed;
                color: @dls-input-font-color-disabled;
            }
        }
    }
}
.@{select-prefix-cls}:not(.@{select-prefix-cls}-disabled) {
    border: 1px solid @dls-input-border-color;
    background-color: @dls-button-background-color-basic;
    color: @dls-input-font-color;
    cursor: pointer;
    &:hover, &:active {
        border-color: @dls-input-border-color-hover;
    }
    &.@{select-prefix-cls}-focus,
    &:focus {
        border-color: @dls-input-border-color-focus;
        box-shadow: @dls-input-shadow-focus;
    }
}
.@{select-prefix-cls} {
    .reset-component();
    display: inline-block;
    position: relative;
    outline: 0;
    width: @dls-input-width;
    padding: 0 @dls-select-padding-x;
    text-align: left;
    &-search-text-disabled {
        color: @dls-option-font-color-disabled !important;
    }
    &-dropdown-menu-footer {
        border-top: 1px solid @dls-option-group-separator-color;
    }
    &-focus {
        border-color: @dls-input-border-color-focus;
        box-shadow: @dls-input-shadow-focus;
    }
    &-open {
        border-color: @dls-input-border-color-hover;
        .@{select-prefix-cls}-arrow {
            transform: rotate(-180deg) translateY(50%);
        }
    }
    &-loading-holder-container {
        text-align: center;
        .@{loading-prefix-cls} {
            padding: 0;
            .@{loading-prefix-cls}-icon-element {
                display: inline-flex;
                align-items: center;
            }
        }
    }
    ul,
    ol {
        margin: 0;
        padding: 0;
        list-style: none;
    }
    > ul > li > a {
        padding: 0;
        background-color: @dls-option-background-color;
    }
    &-error-line {
        border: 1px solid @dls-input-border-color-error !important;
        &:hover, &:focus, &:active {
            border-color: @dls-input-border-color-error !important;
        }
        &:focus {
            box-shadow: @dls-input-shadow-error-focus;
        }
    }
    // arrow
    &-selection__clear,
    &-custom-key,
    &-arrow {
        position: absolute;
        top: 50%;
        right: 0;
        line-height: 1;
        transform: translateY(-50%);
        color: @dls-select-icon-color-aux;
        transition: transform .3s;
        display: inline-flex;
        > svg {
            display: inline-flex;
            justify-content: center;
            align-items: center;
            width: auto;
            height: @dls-icon-size-aux;
        }
    }
    &-selection__clear {
        color: @dls-icon-color-aux;
        z-index: 1;
        opacity: 0;
        font-size: @dls-icon-size-normal;
        right: 0;
    }
    &-selection {
        position: relative;
        outline: none;
        user-select: none;
        box-sizing: border-box;
        display: block;
        border-radius: 0;
        transition: all .3s ease-in-out;
        &:hover &__clear {
            opacity: 1;
        }
        &:hover &__clear + .@{select-prefix-cls}-arrow {
            display: none;
        }

        &-selected-value {
            float: left;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            width: 100%;
            &-selector-name {
                color: @dls-input-placeholder-color;
            }
        }
    }
    &-selection-text-error {
        color: @dls-color-error;
        margin-top: @dls-padding-unit;
    }

    &-disabled &-selection {
        &__clear {
            display: none;
            visibility: hidden;
            pointer-events: none;
        }
    }
    &-disabled &-selection--multiple &-selection__choice {
        &__remove {
            // display: none;
        }
    }
    &-selection--single {
        position: relative;
        // cursor: pointer;
    }
    &-selection__rendered {
        display: block;
        position: relative;
        padding-right: dls-sum(@dls-select-content-spacing, @dls-icon-size-aux);
        &:after {
            content: '.';
            visibility: hidden;
            pointer-events: none;
            display: inline-block;
            width: 0;
            height: 0;
        }
    }
    &-selection__placeholder,
    &-search__field__placeholder {
        position: absolute;
        left: 0;
        padding-right: dls-sum(@dls-select-content-spacing, @dls-icon-size-aux);
        max-width: 100%;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        text-align: left;
        color: @dls-input-placeholder-color;
    }
    &-search__field__placeholder {
        left: 2 * @dls-padding-unit;
    }
    &-search__field__mirror {
        position: absolute;
        top: -2px;
        left: 0;
        white-space: pre;
        pointer-events: none;
        opacity: 0;
        color: @dls-link-font-color-normal;
    }
    &-search--inline {
        position: absolute;
        height: 100%;
        width: 100%;
        .@{select-prefix-cls}-search__field__wrap {
            width: 100%;
            height: 100%;
        }
        .@{select-prefix-cls}-search__field {
            border-width: 0;
            height: 100%;
            width: ~'calc(100% - 12px)';
            background: transparent;
            outline: 0;
            border-radius: 0;
            line-height: 1;
            color: @dls-link-font-color-normal;
        }
        > i {
            float: right;
        }
    }
    &-selection--multiple[type='list'] {
        .clearfix();
        position: relative;
        .@{select-prefix-cls}-search--inline {
            float: left;
            position: relative;
            top: 1px;
            left: 0;
            width: auto;
            padding: 0;
            max-width: ~'calc(100% - 12px)';
            .@{select-prefix-cls}-search__field {
                max-width: 100%;
                width: 0.75em;
            }
        }
        .@{select-prefix-cls}-search-hidden {
            height: 0;
        }
        .@{select-prefix-cls}-search-ul {
            padding: 0;
            margin: 0;
            &:after {
                content: ' ';
                display: table;
                clear: both;
            }
        }
        .@{select-prefix-cls}-selection__rendered {
            height: auto;
            padding-right: @dls-padding-unit * 10;
            &:after {
                display: none;
            }
        }
        .@{select-prefix-cls}-selection__choice {
            color: @dls-tag-color;
            background-color: fade(@dls-tag-color, percentage(@dls-tag-background-opacity));
            border-radius: @dls-tag-border-radius-m;
            font-size: @dls-tag-font-size-s;
            float: left;
            margin-right: @dls-select-tag-spacing;
            max-width: 99%;
            position: relative;
            overflow: hidden;
            transition: padding .3s ease-in-out;
            display: inline-flex;
            align-items: center;
            padding: 0 @dls-tag-padding + 14px + @dls-tag-padding 0 @dls-tag-padding;
            cursor: pointer;
            box-sizing: border-box;
            &__disabled {
                cursor: not-allowed;
                // background-color: @dls-button-background-color-normal;
                opacity: @dls-button-background-color-normal-disabled;
            }
        }
        .@{select-prefix-cls}-selection__choice__content {
            display: inline-block;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100%;
            transition: margin .3s ease-in-out;
        }
        .@{select-prefix-cls}-selection__choice__remove {
            position: absolute;
            right: @dls-tag-padding;
        }
        .@{select-prefix-cls}-selection__clear {
            top: (@dls-option-height-m / 2);
        }
        .@{select-prefix-cls}-selection__total_count {
            right: 0;
            position: absolute;
            color: @dls-icon-color-aux;
            bottom: @dls-select-padding-y;
        }
        .@{select-prefix-cls}-selection__total_count-error {
            color: @dls-color-error;
        }
        .@{select-prefix-cls}-selection__total_count-min {
            right: @dls-select-padding-x + @dls-select-content-spacing;
            top: 50%;
            transform: translateY(-50%);
            height: @dls-option-height-xs - @dls-height-unit;
            line-height: @dls-option-height-xs - @dls-height-unit;
        }
    }
    &-hidden {
        display: none;
    }
}

.@{select-prefix-cls}-multiple {
    .@{select-prefix-cls} {
        width: @dls-select-multiple-width;
    }
}

.select-dropdown-size(@size, @dropdown-height) {
    .@{select-prefix-cls}-dropdown-@{size} {
        .@{select-prefix-cls}-dropdown-menu {
            max-height: @dropdown-height;
        }
    }
}

.@{select-prefix-cls}-dropdown {
    .reset-component();
    font-variant: initial;
    &.slide-up-enter.slide-up-enter-active&-placement-bottomLeft,
    &.slide-up-appear.slide-up-appear-active&-placement-bottomLeft {
        @animation-name: oneUISlideUpInEffect;
    }
    &.slide-up-enter.slide-up-enter-active&-placement-topLeft,
    &.slide-up-appear.slide-up-appear-active&-placement-topLeft {
        animation-name: oneUISlideDownInEffect;
    }
    &.slide-up-leave.slide-up-leave-active&-placement-bottomLeft {
        animation-name: oneUISlideUpOutEffect;
    }
    &.slide-up-leave.slide-up-leave-active&-placement-topLeft {
        animation-name: oneUISlideDownOutEffect;
    }
    &-hidden {
        display: none;
    }
    background-color: @dls-option-background-color;
    box-shadow: @dls-dropdown-menu-shadow;
    overflow-y: auto;
    box-sizing: border-box;
    z-index: @dls-select-z-index;
    left: -9999px;
    top: -9999px;
    position: absolute;
    outline: none;
    &-menu {
        outline: none;
        margin: 0;
        padding-left: 0;
        list-style: none;
        overflow: auto;
        &-item-group-list {
            margin: 0;
            padding: 0;
        }
        &-item-group-title {
            color: @dls-option-group-label-font-color;
            background-color: @dls-option-background-color;
        }
        &-item-group-list &-item:first-child:not(:last-child),
        &-item-group:not(:last-child) &-item-group-list &-item:last-child {
            border-radius: 0;
        }
        &-item-group:not(:first-child) {
            margin-top: 2px;
            border-top: 1px solid @dls-option-group-separator-color;
        }
        &-item[type='custom'] {
            position: relative;
            display: block;
        }
        &-item {
            position: relative;
            display: block;
            white-space: nowrap;
            cursor: pointer;
            overflow: hidden;
            text-overflow: ellipsis;
            transition: background 0.3s ease;
            &-active {
                background-color: @dls-option-background-color-focus;
            }
            .option-color-normal();
            &-selected {
                .option-color-normal-selected();
            }
            &-divider {
                height: 1px;
                margin: 1px 0;
                overflow: hidden;
                background-color: @dls-option-group-separator-color;
                line-height: 0;
            }
        }
        &-item-disabled {
            .option-color-normal-disabled();
        }
        &-container {
            overflow: auto;
        }
        .@{select-checkbox-cls} {
            font-size: inherit;
        }
    }
    &--multiple {
        .@{select-prefix-cls}-dropdown-menu-item-selected {
            .@{select-checkbox-cls} + span {
                .option-color-normal(
                    transparent,
                    @dls-option-font-color,
                    transparent,
                    @dls-option-font-color-hover,
                    transparent,
                    @dls-option-font-color-hover,
                    transparent,
                    @dls-option-font-color-focus
                );
            }
        }
    }
}

.select-dropdown-size(xsmall, @dls-dropdown-menu-max-height-xs);
.select-dropdown-size(small, @dls-dropdown-menu-max-height-s);
.select-dropdown-size(medium, @dls-dropdown-menu-max-height-m);
.select-dropdown-size(large, @dls-dropdown-menu-max-height-l);

.@{select-prefix-cls}-search-text-highlight {
    color: @dls-color-warning;
}
.@{single-select-prefix-cls} {
    background: @dls-option-background-color;
    cursor: pointer;
    position: relative;
    color: @dls-link-font-color-normal;
    border: 1px solid @dls-border-color-current;
    padding-right: 4 * @dls-padding-unit;
    box-sizing: border-box;
    height: @dls-option-height-m;
    line-height: 1;
    display: inline-block;
    vertical-align: middle;
    &-text {
        font-size: @dls-font-size-0;
        padding: 0 2 * @dls-padding-unit;
        display: inline-block;
        line-height: @dls-option-height-m - 2px;
        height: @dls-option-height-m - 2px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        width: 100%;
    }
    &:hover {
        border: 1px solid @dls-border-color-current;
    }
    .@{select-prefix-cls}-focus &,
    &:focus,
    &:active {
        border: 1px solid @dls-border-color-current;
        box-shadow: @dls-input-shadow-focus;
    }
    &-open {
        .@{select-prefix-cls}-arrow {
            transform: rotate(-180deg) translateY(50%);
        }
    }
    &-disabled {
        background: @dls-option-font-color-disabled;
        cursor: not-allowed;
        color: @dls-option-font-color-disabled;
        &:hover {
            border: 1px solid @dls-option-font-color-disabled;
        }
        .@{select-prefix-cls}-focus &,
        &:focus,
        &:active {
            border: 1px solid @dls-option-font-color-disabled;
        }
    }
}

.@{multiple-select-prefix-cls} {
    position: relative;
    &-open {
        .@{select-prefix-cls}-arrow {
            transform: rotate(-180deg) translateY(50%);
        }
    }
    &-text-label {
        display: inline-block;
    }
}
.@{select-popover-prefix-cls} {
    .reset-component();
    padding: 2 * @dls-padding-unit;
    font-variant: initial;
    &.slide-up-enter.slide-up-enter-active&-placement-bottomLeft,
    &.slide-up-appear.slide-up-appear-active&-placement-bottomLeft {
        @animation-name: oneUISlideUpInEffect;
    }
    &.slide-up-enter.slide-up-enter-active&-placement-topLeft,
    &.slide-up-appear.slide-up-appear-active&-placement-topLeft {
        animation-name: oneUISlideDownInEffect;
    }
    &.slide-up-leave.slide-up-leave-active&-placement-bottomLeft {
        animation-name: oneUISlideUpOutEffect;
    }
    &.slide-up-leave.slide-up-leave-active&-placement-topLeft {
        animation-name: oneUISlideDownOutEffect;
    }
    &-hidden {
        display: none;
    }
    background-color: @dls-option-background-color;
    box-shadow: @dls-dropdown-menu-shadow;
    border-radius: 0;
    box-sizing: border-box;
    z-index: @dls-select-z-index;
    left: -9999px;
    top: -9999px;
    position: absolute;
    outline: none;
}

.@{select-popover-prefix-cls}-container {
    width: @dls-dropdown-menu-max-height-s;
    &-open {
        .@{select-prefix-cls}-arrow {
            transform: rotate(-180deg) translateY(50%);
        }
    }
    .@{select-prefix-cls}-selection__total {
        top: 0 !important;
        left: 2 * @dls-padding-unit !important;
    }
    .@{select-prefix-cls}-selection {
        cursor: auto;
    }
}
.@{select-popover-prefix-cls}-inner {
    width: 100%;
    &-container {
        display: inline-block;
        width: 100%;
        &-custom {
            margin-bottom: 2 * @dls-padding-unit;
        }
        &-button-item {
            margin-right: 2 * @dls-padding-unit;
        }
    }
}
.@{select-pop-prefix-cls} {
    .reset-component();
    font-variant: initial;
    &.slide-up-enter.slide-up-enter-active&-placement-bottomLeft,
    &.slide-up-appear.slide-up-appear-active&-placement-bottomLeft {
        @animation-name: oneUISlideUpInEffect;
    }
    &.slide-up-enter.slide-up-enter-active&-placement-topLeft,
    &.slide-up-appear.slide-up-appear-active&-placement-topLeft {
        animation-name: oneUISlideDownInEffect;
    }
    &.slide-up-leave.slide-up-leave-active&-placement-bottomLeft {
        animation-name: oneUISlideUpOutEffect;
    }
    &.slide-up-leave.slide-up-leave-active&-placement-topLeft {
        animation-name: oneUISlideDownOutEffect;
    }
    &-hidden {
        display: none;
    }
    background-color: @dls-option-background-color;
    box-shadow: @dls-dropdown-menu-shadow;
    border-radius: 0;
    box-sizing: border-box;
    z-index: @dls-select-z-index;
    left: -9999px;
    top: -9999px;
    position: absolute;
    outline: none;
}
.@{select-prefix-cls}-container {
    display: inline-flex;
    flex-direction: column;
    vertical-align: middle;
}
.one-invalid(@select-prefix-cls);
.one-invalid(@select-prefix-cls, ~"@{select-prefix-cls}-container");
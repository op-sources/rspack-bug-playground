/**
 * @file date util
 * @author tangjinhua
 */
import dayjs from "dayjs"; // 下拉偏移重置为0, 0

export var align = {
  offset: [0, 0]
};
/**
 * 根据日期选择范围与单元返回有效日期
 *
 * @param date 日期
 * @param dateFormat 格式
 * @param minDate 最小日期
 * @param maxDate 最大日期
 * @param mode 单位
 * @param end 是否为结束日期
 * @returns 有效日期
 */

export var getValidDate = function getValidDate(date, dateFormat, minDate, maxDate, mode, end) {
  var minTime = minDate ? dayjs(minDate).valueOf() : null;
  var maxTime = maxDate ? dayjs(maxDate).valueOf() : null;
  var validDate;

  if (mode === 'week') {
    if (end) {
      var dateTime = dayjs(date).endOf(mode).startOf('day').valueOf();
      validDate = maxTime && dateTime > maxTime ? maxTime : dateTime;
    } else {
      var _dateTime = dayjs(date).startOf(mode).valueOf();

      validDate = minTime && _dateTime < minTime ? minTime : _dateTime;
    }
  } else {
    validDate = date;
  }

  return dayjs(validDate).format(dateFormat);
};
/**
 * 根据日期选择范围返回有效自然周日期
 *
 * @param date 日期
 * @param dateFormat 格式
 * @param minDate 最小日期
 * @param maxDate 最大日期
 * @returns 有效日期
 */

export var getValidWeekDates = function getValidWeekDates(date, dateFormat, minDate, maxDate) {
  var minTime = minDate ? dayjs(minDate).valueOf() : null;
  var maxTime = maxDate ? dayjs(maxDate).valueOf() : null;
  var startDateTime = dayjs(date).startOf('week').valueOf();
  var startValidDate = minTime && startDateTime < minTime ? minTime : startDateTime;
  var endDateTime = dayjs(date).endOf('week').startOf('day').valueOf();
  var endValidDate = maxTime && endDateTime > maxTime ? maxTime : endDateTime;
  return [dayjs(startValidDate).format(dateFormat), dayjs(endValidDate).format(dateFormat)];
};